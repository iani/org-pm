This file is for experiments for preparing new features.

Sun, May 17 2015, 17:49 EEST


* Local Projects
:PROPERTIES:
:DATE:     <2015-05-17 Sun 17:57>
:END:

When developing, one may want to keep all files (css, js, source files, exports) of a project in the same folder as the original org-mode file that is used for creating the site, instead of exporting to the global org-pm-projects folder.  Here we try to build this optional feature to the existing framework, using =let= to temporarily change the value of =org-pm-root-dir= to the folder of the current org-mode file + "EXPORTS".

#+BEGIN_SRC elisp
  (let ((org-pm-root-dir
         (concat
          (file-truename
           (file-name-directory (buffer-file-name)))
          "/EXPORTS")))
    (unless (file-exists-p org-pm-root-dir)
      (message "WILL NOW CREATE %s" org-pm-root-dir)
      (mkdir org-pm-root-dir t))
    (call-interactively 'org-pm-menu))
#+END_SRC

#+BEGIN_SRC emacs-lisp
  (defun org-pm-menu-local ()
    "Present org-pm-menu using current file's folder + EXPORTS as project root."
    (interactive)
    (let ((org-pm-root-dir
           (concat
            (file-truename
             (file-name-directory (buffer-file-name)))
            "/EXPORTS")))
      (unless (file-exists-p org-pm-root-dir)
        (message "WILL NOW CREATE %s" org-pm-root-dir)
        (mkdir org-pm-root-dir t))
      (call-interactively 'org-pm-menu)))

  (global-set-key (kbd "H-e H-m") 'org-pm-menu-local)
#+END_SRC
